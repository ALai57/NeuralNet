<!doctype html>
<html lang="en">
	<head>
		<link rel="stylesheet" href="./bootstrap.min.css"/>
		
		<meta name="generator" content="BBEdit">
		<script type="text/javascript"
		   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js">   
		</script>
		<script src="./d3.min.js"> </script>
		<script src="./d3-tip.js"> </script>
		<script src="./jquery-3.2.1.min.js"> </script>
		<script src="./bootstrap.min.js"> </script>
		<script src="./d3.rebind.js"></script>
		<style>
		h1 { font-weight: bold; }
		h3 { font-weight: bold; }
		h4 { font-weight: bold; font-style: italic; }
		</style>
	</head>
	
	<body>	
		<script src="./tableFunctions.js"></script>
		<script src="./neuralNetworkFunctions.js"></script>
		
		<script>
			//Inputs and configuration
			
			//SVG drawing size
			var wd = 500;
			var ht = 400;
			
			var x = d3.scaleLinear().domain([-2, 10])
									.range([0, wd]);
			var y = d3.scaleLinear().domain([5,-5])
									.range([0, ht]);
									
			function translate(xIn,yIn){
				return "translate(" + xIn + "," + yIn + ")";
			}
			function translateRotate(xIn,yIn,rIn,wdth,hgt){
				return "translate(" + xIn + "," + yIn + ")" + "rotate(" + rIn + "," + wdth + "," + hgt + ")";;
			}
			
			
			function calcWidth(w){
				return Math.abs(x(w)-x(0));
			}
			function calcHeight(h){
				return Math.abs(y(h)-y(0));
			}
			
			MathJax.Hub.Config({
			  skipStartupTypeset:true
			});

			MathJax.Hub.Queue(

			  ["setRenderer",MathJax.Hub,"CommonHTML"],
			  ["Typeset",MathJax.Hub,"ANN_Equation"],
			  ["Typeset",MathJax.Hub,"ANN_Equation_ws"],
			  ["Typeset",MathJax.Hub,"drEqn"],
			  
			  ["setRenderer",MathJax.Hub,"SVG"],
			  ["Typeset",MathJax.Hub,"explodedEqn"]
			);
			
		</script>
		

		<div class="container"> 
		<div class = "row"> <div class="col-md-6 col-md-offset-3">
			<h1>Artificial Neural Networks</h1>
			<br>
			
			<h3>INTRODUCTION</h3>
			<p>Computers are getting eerily smart.</p>
			<p>Today, Amazon Alexa is recognizing words in our speech. iPhones are recognizing faces in photos and videos. And self-driving cars are recognizing objects, places, and hazards on the road.</p>
			<p>But what is powering the ability to recognize voices, streets and people?</p> 
			<p>How can Amazon Alexa understand our voices? How can self driving cars see and understand the road? And how can iPhones recognize our faces?</p>
			<p>The answer: all of these technologies are made possible by artificial neural networks.</p>
			<br>
			
			<h3>WHAT IS AN ARTIFICIAL NEURAL NETWORK? </h3>
			<p>At its most basic level, an artificial neural network is a mathematical equation. And, surprisingly, artificial neural networks rely on simple mathematics; typically, artificial neural networks only perform addition, subtraction, multiplication, and exponentiation. In fact, you can easily replicate the same calculations with a simple calculator and these four buttons:   +   -   x   exp()</p>  
			<p>What makes neural networks so special is in the way the calculations are performed. When these operations are combined in the right order, we can get computer to recognize your voice - we just need a fast computer and a data set (preferably, a large one).</p>
			<br>

			<h3>AN EXAMPLE NEURAL NETWORK</h3>
			<p>To better illustrate what an artificial neural network is and how it works, let's walk through a simple example.</p> 
			<p>Imagine that we are creating a medical robot (href = Big Hero 6!). The robot is supposed to measure a patient's heart rate and core temperature, and use that information to recognize when people are sick.  And just like Alexa, this robot will use a neural network to recognize sick patients.</p>
			<p>Our example neural network is below. Click any of the terms to get an explanation.</p>
			<div id='ANN_Equation'>
				<!-- <p>[THIS SHOULD HAVE INTERACTIVE HOVER-OVER AND CLICKABLE BEHAVIOR IN THE FINAL ARTICLE]</p>  -->
				<p>\[ \Large{ S_{pred} = \frac{1}{1+e^{ - \left(\frac{w_5 }{1 + e^{-\left(T\cdot w_1+ {HR}\cdot w_2 \right)}} +\frac{w_6}{1 + e^{-\left(T\cdot w_3+ {HR}\cdot w_4\right)}} \right) } }  }  \] </p>
			</div>
			
			<p>The artificial neural network looks complicated because it has so many terms. But take a closer look. The mathematical operations are simple - addition, subtraction, multiplication and exponentiation. In reality, our artificial neural network is a combination of many simple mathematical steps.</p>
			<p>This is the foundation for the more advanced networks used in Alexa and other cutting edge- technologies. Pretty incredible that you could do most of Alexa's calculations on your calculator, right?</p>
			<br>
			
			<h3>MAKING PREDICTIONS WITH A NEURAL NETWORK</h3>
			<p>Right now, we could take out a calculator and start making predictions using the example neural network. All we need is our patient's temperature, heart rate, and the w values. Then, we would plug those values into the equation above. And, voila! Out comes our prediction of whether our patient is sick or not. </p>
			<p>However, there's a catch. For the network to be useful, we need the predictions to be accurate, and the key to making accurate predictions is finding the best values for the w terms in the equation. You can think of these w's like settings - when we change the settings, we change the network equation. And when the network equation changes, our predictions can get better or worse.</p>
			<div id='ANN_Equation_ws'>
				<p>\[ \Large{ S_{pred} = \frac{1}{1+e^{ - \left(\frac{\color{red} w_{\color{red} 5} }{1 + e^{-\left(T\cdot \color{red} w_{\color{red} 1}+ {HR}\cdot  \color{red} w_{\color{red} 2} \right)}} +\frac{\color{red} w_{\color{red} 6}}{1 + e^{-\left(T\cdot \color{red} w_{\color{red} 3}+ {HR}\cdot \color{red} w_{\color{red} 4} \right)}} \right) } }  }  \] </p>
			</div>
			<p>Ultimately, if we get the settings right, we can get our neural network to recognize sick patients! That's exactly the same way that Alexa can recognize your voice â€“ in her neural network she has found the right settings to make her predictions really good. But unlike our example, Alexa most likely has hundreds or thousands of w settings in total, compared to our robot's six (w1, w2, w3, w4, w5, and w6).</p>
			<br>
			
			<h3>TRAINING A NEURAL NETWORK TO MAKE BETTER PREDICTIONS</h3>
			<p>The real challenge of a neural network is to learn the w settings that make the predictions as good as possible. This process of learning the best settings is called "training". Unfortunately, when we are just starting out, we have no idea what the settings should be. Our best option is to start by guessing values for the ws. </p>
			<p>In this example, we will start by guessing that every setting is equal to 1 (w1 = w2 = w3 = w4 = w5 = w6 = 1).</p>
			
			<h4>Collecting data to train the network</h4>
			<p>The training process requires some data - which we need to collect or find in a database.</p>
			<p>In our robot example, we will hire a doctor. The doctor will examine 10 patients, measuring their heart rate (HR), temperature (T), and whether they were sick or not (S).</p>
			<div id='DoctorDiv'>
				<p><strong>[Click the doctor to collect data from each patient!]</strong></p>
				<!-- <div class='ANN_Table'></div> -->
				<script src="./doctor.js"></script>
			</div>
			
			<h4>The network's first predictions</h4>
			<p>Training a network is a trial-and-error process. Now that we have our data, we need to try out our equation and see if the w values work well. First, we will plug our w values into the equation (remember, to start we guessed that all ws = 1). Then, for each subject, we will plug in the subject's temperature, heart rate. Once this is done, we can calculate our predictions of whether the patient was sick or not.</p> 
			<div id='RobotDoctorDiv'>
				<p><strong>[Click the gears to read in patient data and predict if the patient is sick or not.]</strong></p>
				<script src="./robotdoctor.js"></script>
			</div>
			<h4>Making better predictions</h4>
			<p>The first predictions are awful, because we started off by guessing that all ws = 1. In fact, the network predictions were almost identical for all of the patients. This was the "trial" part of "trial and error".</p>
			<p>After trying our equation, we correct for any errors the network made. This is the "error" part of the trial-and-error. At this stage, we update the w settings to make the errors a little bit smaller. And we repeat this process over and over. We can use many different rules to update our w values, but this is beyond the scope of this article. </p>
			<p>To truly train an artificial neural network well, we change the settings many times: sometimes thousands of times, sometimes millions of times, and sometimes even more! And eventually, our network makes smaller and smaller errors as we update the settings.</p>
			<div id='Error'>
				<!-- <p>[Error decreasing over time]</p> -->
			</div>

			
			<h3>THE CONNECTION BETWEEN ARTIFICIAL NEURAL NETWORKS AND BRAINS.</h3> 
			<p>In real brains, brain cells communicate using electrical pulses. Real brain cells are great listeners because, first, they listen to signals other brain cells are sending them. Only after they listen do they decide to how to respond.</p> 
			<p>Communication between real brain cells can lead to works of art, engineering marvels, and the full spectrum of human behaviors. Noticing how incredible abilities all arise from cells communicating with one another, Artificial neural networks try to imitate the way real brain cells communicate. 
			<p>In particular, there are two behaviors that are explicitly programmed into an artificial neural network.</p>

			<p><strong>1) Threshold.</strong> 
			In a real brain, each cell receives electrical signals from other brain cells. The total of all signals coming in to a cell is like an<strong>input</strong>.
			<p>If a brain cell doesn't receive enough input, it will not send any electrical signals of its own. Essentially, there's a threshold effect - once the cell gets enough electrical input, it will respond. Below the threshold, nothing happens. Above the threshold value, more input leads to more output.</p>
			
			<!-- <p>The figure below shows data from real neurons - it shows that once neurons get enough signals coming in, they start sending signals of their own.</p> -->
			
			<!-- <p>Beer RD (1990) Intelligence as Adaptive Behavior: An Experiment in Computational Neuroethology. San Diego: Acadmic Press, Inc.</p> -->

			<p><strong>2) Selective listening.</strong> Normally, brain cells receive electrical signals from many other cells. However, not all signals are equal; each brain cell listens more to some cells than others. 
			<p>Just like advice from a trusted friend may count more than advice from a reckless friend, signals from some neurons count more than signals from other neurons. For example, some signals could be worth 3x more than others. And some signals could be worth nothing at all.</p>
			<p>Click the example below to see how the neural network equation imitates biological brains.</p>
			<div id='EquationExplode'>
				<script src="./equationExplodeFunctions.js"></script>
			</div>
			<br>
			<h3>Artificial Neural Networks are Imitation Brains</h3> 
			<p>So, why imitate biological brains?</p>
			<p>Biological brains can learn, and get better and better at different tasks. This is a really desirable feature for a computer program - even a simplified version of a brain can be taught to recognize faces or voices. So next time you talk to Siri, just remember, she's working with some similar hardware - but right now, you just have the more advanced version.</p>
</p>
			
		</div></div>
		<div id="NetworkGraph"></div>
		</div>
		

	</body>
	
</html>