<!doctype html>
<html lang="en">
	<head>
		<link rel="stylesheet" href="./bootstrap.min.css"/>
		 <script type="text/javascript"
		   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_SVG">
		</script>
		
	</head>
	
	<body>	
		<script src="./jquery-3.2.1.min.js"> </script>
		<script src="./bootstrap.min.js"> </script>
		<script src="./d3.min.js"> </script>
		<script src="./d3.slider.js"></script>
		<script src="./d3.rebind.js"></script>
		
		
		
		<div class="container"> 
		<div class = "row"> <div class="col-md-6 col-md-offset-3">
			<h2>Hello!</h2>

			<p>This code explodes the equation.</p>
			<p></p>
		</div></div>
		<div id="NetworkGraph"></div>
		<div id="TableOut"></div>
				
		</div>
		<script>
		
			//SVG drawing size
			var wd = 600;
			var ht = 600;
			
		</script>
		<script src="./setupAxes.js"></script>		
		
		<script> 
			
			var svg = d3.select('svg');
			var theEqn = d3.select('svg').append("foreignObject")
			  .attr("width", 580)
			  .attr("height", 500)
    		  .attr('y',y(5))
			  .append("xhtml:body");
			
			theEqn.append('div')
				.style('font-size','50%')
				.attr('id','explodedEqn')
				.text(' \\[ \\Huge{ S_{pred} = \\frac{1}{1+e^{ \\frac{\\color{black} w_{\\color{black} 5} }{1 + e^{\\color{black} T\\cdot \\color{black} w_{\\color{black} 1}+ \\color{black} H \\color{black} R\\cdot \\color{black} w_{\\color{black} 2}}} +\\frac{\\color{black} w_{\\color{black} 6}}{1 + e^{\\color{black} T\\cdot \\color{black} w_{\\color{black} 3}+ \\color{black} H \\color{black} R\\cdot \\color{black} w_{\\color{black} 4}}}  } }  }  \\] ');
			
			var eqnG;
			var eqnX;
			var eqnY;
			var eqnZ;
			var eqnBar1;
			var eqn1;
			var eqnBar23;
			var eqnW56;
			var eqn1P;
			var eqne;
			
			var eqn2P;
			var eqnL;
			var eqnR;
			var eqnAy;
			var eqnAz;
			
			MathJax.Hub.Queue(function () {
				mathInit();
				d3.select('#explodedEqn').selectAll('svg')
				.attr('width',580)
				.attr('height',580);
				
				eqnG = d3.select('#explodedEqn').selectAll('svg').selectAll(function(){return this.childNodes;});
				
				eqnG.attr('transform', "matrix(1, 0, 0, -1, 0, -20000)" );
				
				eqnX = d3.selectAll('g[transform = "translate(1161,2927)"]');
				eqnY = d3.selectAll('g[transform = "translate(1101,1017)"]');
				eqnZ = d3.selectAll('g[transform = "translate(1101,1067)"]');
				eqnBar1 = d3.selectAll('rect[width="48190"]');
				eqn1 = d3.selectAll('use[y="676"]');
				eqnBar23 = d3.selectAll('g[transform="translate(298,0)"]')
					.selectAll('rect');
				eqnW56 = d3.selectAll('g[transform="translate(8234,1777)"]');
				
				eqn1P = d3.select('#explodedEqn').selectAll('g[transform="translate(149,-5651)"]').selectAll(function(){
						return this.childNodes;})
						.filter(function (d, i) { return i === 1 || i === 0;});
						
				eqne = d3.select('#explodedEqn').selectAll('g[transform="translate(4291,0)"]').selectAll(function(){
						return this.childNodes;})
						.filter(function (d, i) { return i === 0;});
						
				eqn2P = d3.selectAll('use[x="8547"]');	
				eqnL  = d3.selectAll('g[transform="translate(1161,2927)"]');
				eqnR  =	d3.selectAll('g[transform="translate(22013,0)"]');
				eqnAy1 = eqnL.selectAll(function(){
						return this.childNodes;})
						.filter(function (d, i) { return i === 0})
						.selectAll(function(){
						return this.childNodes;}).filter(function (d, i) { return i === 0;});
				eqnAy2 = eqnL.selectAll(function(){
						return this.childNodes;})
						.filter(function (d, i) { return i === 0})
						.selectAll(function(){
						return this.childNodes;}).filter(function (d, i) { return i===2;});
						
				eqnAz1 = eqnR.selectAll(function(){
						return this.childNodes;})
						.filter(function (d, i) { return i === 0})
						.selectAll(function(){
						return this.childNodes;}).filter(function (d, i) { return i === 0;});
				eqnAz2 = eqnR.selectAll(function(){
						return this.childNodes;})
						.filter(function (d, i) { return i === 0})
						.selectAll(function(){
						return this.childNodes;}).filter(function (d, i) { return i===2;});
						
				d3.select('#explodedEqn').selectAll('svg').attr('viewBox',"0 -4000 62078 9602.6");
			});

			function explodeEqn(){
				eqnX.transition().duration(1000)
						.attr('transform', 'translate(-4500,-6000)')
						.on('end',function(){
						
				d3.selectAll('svg').selectAll('#xvar').data([0])
					.enter().append('text')
					.style('opacity',0)
					.attr('id','xvar')
					.transition().delay(500)
					.attr('x', x(-1.1))
					.attr('y', y(1.46))
					.style('opacity',1)
					.text('x =')
					.style('font-size','18pt')
					.style('font-family','Times');
					
				d3.selectAll('svg').selectAll('#xvar2').data([0])
					.enter().append('text')
					.style('opacity',0)
					.attr('id','xvar2')
					.transition().delay(500)
					.attr('x', x(3.7))
					.attr('y', y(3.1))
					.style('opacity',1)
					.text('x')
					.style('font-family','Times')
					.style('font-size','18pt');	
				
				svg.selectAll('#neuron3').data([0])
					.enter().append('circle')
					.style('fill','none')
					.style('stroke','red')
					.attr('id','neuron3')
					.transition().delay(500)
					.attr('cx', x(3.2))
					.attr('cy', y(3.3))
                    .attr('r', 60);
				
					});
				
				eqnBar1.transition().duration(1000)
					.attr('width',10000)
					.attr('x',13000);
				eqn1.transition().duration(1000)
					.attr('x',7000)
					.attr('y',800);
				eqn1P.transition().duration(1000)
					.attr('y',1000)
                    .attr('x',function(d,i){return 5500+i*800;});
				eqne.transition().duration(1000)
					.attr('y',1000)
					.attr('x',5700);
			}
			
			function undoExplodeEqn(){
			
				d3.selectAll('svg').selectAll('#xvar').remove();
				d3.selectAll('svg').selectAll('#xvar2').remove();
				d3.selectAll('svg').selectAll('#neuron3').remove();
			
				eqnX.transition().duration(1000)
						.attr('transform', 'translate(1161,2927)');
						
				
				eqnBar1.transition().duration(1000)
					.attr('width',48190)
					.attr('x',0);
				eqn1.transition().duration(1000)
					.attr('x',9426);
				eqn1P.transition().duration(1000)
					.attr('y',0)
					.attr('x',function(d,i){return i*800;});
				eqne.transition().duration(1000)
					.attr('y',0)
					.attr('x',0);
					
			}
			
			function explodeEqn2(){
				eqn2P.transition().duration(1000)
					.attr('transform','scale(3)');
				eqnR.transition().duration(1000)
					.attr('transform','translate(28000,0)');
				
				eqnW56.transition().duration(1000)
					.attr('transform','translate(21000,0)');
				
				svg.selectAll('.myones').data([1.8,7])
					.enter().append('text')
					.attr('class','myones')
					.text('1')
					.style('font-family','Times')
					.style('opacity',0)
					.style('font-size',22)
					.attr('x',function(d){return x(d);})
					.attr('y',y(1.7))
					.transition().duration(1000)
					.style('opacity',1);
					
				svg.selectAll('.dots').data([1.75+1.8,7+1.8])
					.enter().append('text')
					.attr('class','dots')
					.text('.')
					.style('font-family','Times')
					.style('opacity',0)
					.style('font-size',62)
					.attr('x',function(d){return x(d);})
					.attr('y',y(1.5))
					.transition().duration(1000)
					.style('opacity',1);	
			}
			
			function undoExplodeEqn2(){
				
				d3.selectAll('svg').selectAll('.myones').remove();	
				d3.selectAll('svg').selectAll('.dots').remove();
				
				eqn2P.transition().duration(1000)
					.attr('transform','scale(2.361)');
				eqnR.transition().duration(1000)
					.attr('transform','translate(22013,0)');
				
				eqnW56.transition().duration(1000)
					.attr('transform','translate(8234,1777)');
					
			}
			
			function getTransform(tIn){
				if (tIn===NaN){
					return [0,0];
				}
				return tIn.substring(tIn.indexOf("(")+1, tIn.indexOf(")")).split(",");
			}
			
			function explodeEqn3(){
				var temp = svg.selectAll('.myones');
				
				temp.transition().duration(1000)
					.attr('y',y(-0.5));
					<!-- .attr('x',function(d,i){return x(0.4)+i*(x(6.15)-x(0));}); -->

				
				eqnAy1.transition().duration(1000)
					.attr('y',-14000);
					
                    <!-- .attr('x',4500); -->
				eqnAy2.transition().duration(1000)
					.attr('transform','translate(149,-17500)')
					.on('end',function(){
						
				d3.selectAll('svg').selectAll('#yvar').data([0])
					.enter().append('text')
					.style('opacity',0)
					.attr('id','yvar')
					.transition().delay(500)
					.attr('x', x(-1.1))
					.attr('y', y(-0.8))
					.style('opacity',1)
					.text('y =')
					.style('font-size','18pt')
					.style('font-family','Times');
					
				d3.selectAll('svg').selectAll('#yvar2').data([0])
					.enter().append('text')
					.style('opacity',0)
					.attr('id','yvar2')
					.style('font-size',22)
					.text('y')
					.transition().delay(500)
					.attr('x', x(1.4))
					.attr('y', y(1.46))
					.style('opacity',1)
					.style('font-family','Times');	
						
					});
					
				eqnAz1.transition().duration(1000)
					.attr('y',-14000)
					.attr('x',4500);
				eqnAz2.transition().duration(1000)
					.attr('transform','translate(5000,-17500)')
					.on('end',function(){
						
				d3.selectAll('svg').selectAll('#zvar').data([0])
					.enter().append('text')
					.style('opacity',0)
					.attr('id','zvar')
					.transition().delay(500)
					.attr('x', x(5.1))
					.attr('y', y(-0.8))
					.style('opacity',1)
					.text('z =')
					.style('font-size','18pt')
					.style('font-family','Times');
					
				d3.selectAll('svg').selectAll('#zvar2').data([0])
					.enter().append('text')
					.style('opacity',0)
					.attr('id','zvar2')
					.style('font-size',22)
					.text('z')
					.transition().delay(500)
					.attr('x', x(7))
					.attr('y', y(1.46))
					.style('opacity',1)
					.style('font-family','Times')
					.on('end',function(){return consolidateXeqn();});
					
				
					});
			}
			
			function consolidateXeqn(){
				d3.selectAll('#xvar').transition().duration(1000)
					.attr('x',x(0)); 
				<!-- 45 -->
				d3.selectAll('#yvar2').transition().duration(1000)
					.attr('x',x(1.75));
				d3.selectAll('.dots').transition().duration(1000)
					.attr('x',function(d,i){return x(2.1)+i*125;});
				eqnW56.transition().duration(1000)
					.attr('transform',function(d,i){if(i===0){return 'translate(14000,0)';} else {return 'translate(-1000,0)';} });
				eqn2P.transition().duration(1000)
					.attr('x',6400);
				d3.selectAll('#zvar2').transition().duration(1000)
					.attr('x',x(4.2));
					
				svg.selectAll('#input3').data([0])
					.enter().append('rect')
					.style('fill','none')
					.style('stroke','red')
					.attr('id','input3')
					.transition().delay(500)
					.attr('x',170)
					.attr('y',185)
					.attr('rx', 20)
					.attr('ry', 20)
					.attr('width',230)
					.attr('height',50);
			}
			
			function explodeEqn4(){
				svg.selectAll('.myones').transition().duration(1000)
					.attr('x',function(d,i){return x(0.4)+i*(x(6.15)-x(0));});
			
				eqnY.transition().duration(1000)
						.attr('transform', 'translate(-5000,-8500)')
						.on('end',function(){
						
					d3.selectAll('svg').selectAll('#yvar')
						.transition().delay(500)
						.attr('x', x(-1.5));
						
						
						});
				
				eqnBar23.transition().duration(1000)
					.attr('width',8000);
				
						
				eqnZ.transition().duration(1000)
						.attr('transform', 'translate(-5000,-8500)')
						.on('end',function(){
						
				d3.selectAll('svg').selectAll('#zvar')
					.transition().delay(500)
					.attr('x', x(4.7));
					

				svg.selectAll('#neuron2').data([0])
					.enter().append('circle')
					.style('fill','none')
					.style('stroke','red')
					.attr('id','neuron2')
					.transition().delay(500)
					.attr('cx', x(6.7))
					.attr('cy', y(-0.7))
                    .attr('r', 60);
					
				svg.selectAll('#neuron1').data([0])
					.enter().append('circle')
					.style('fill','none')
					.style('stroke','red')
					.attr('id','neuron1')
					.transition().delay(500)
					.attr('cx', x(0.6))
					.attr('cy', y(-0.7))
                    .attr('r', 60);		
					});	
			}
			
			
			var S_up;
			var S_down;
			// W Variables
			var w1_up;
			var w1_down;
			var w2_up;
			var w2_down;
			var w3_up;
			var w3_down;
			var w4_up;
			var w4_down;
			var w5_up;
			var w5_down;
			var w6_up;
			var w6_down;
			// T and HR variables
			var T_1;
			var T_2;
			var HR_1;
			var HR_2;
			
			function mathInit(){
				// S variable
				S_up   = d3.select('#MJXc-Node-8').selectAll('.mjx-char');
				S_down = d3.select('#MJXc-Node-11').selectAll('.mjx-char').text('pblack');
				// W Variables
				w1_up   = d3.select('#MJXc-Node-49').selectAll('.mjx-char');
				w1_down = d3.select('#MJXc-Node-54').selectAll('.mjx-char');
				w2_up   = d3.select('#MJXc-Node-66').selectAll('.mjx-char');
				w2_down = d3.select('#MJXc-Node-71').selectAll('.mjx-char');
				w3_up   = d3.select('#MJXc-Node-97').selectAll('.mjx-char');
				w3_down = d3.select('#MJXc-Node-102').selectAll('.mjx-char');
				w4_up   = d3.select('#MJXc-Node-114').selectAll('.mjx-char');
				w4_down = d3.select('#MJXc-Node-119').selectAll('.mjx-char');
				w5_up   = d3.select('#MJXc-Node-29').selectAll('.mjx-char');
				w5_down = d3.select('#MJXc-Node-34').selectAll('.mjx-char');
				w6_up   = d3.select('#MJXc-Node-77').selectAll('.mjx-char');
				w6_down = d3.select('#MJXc-Node-82').selectAll('.mjx-char');
				// T and HR variables
				T_1  = d3.select('#MJXc-Node-44').selectAll('.mjx-char');
				T_2  = d3.select('#MJXc-Node-92').selectAll('.mjx-char');
				HR_1 = d3.select('#MJXc-Node-58').selectAll('.mjx-char').text('HR');
				HR_2 = d3.select('#MJXc-Node-106').selectAll('.mjx-char').text('HR');
				
				
				// Remove 'r','e','d' from 'pblack'
				d3.select('#MJXc-Node-12').selectAll('.mjx-char').remove();
				d3.select('#MJXc-Node-13').selectAll('.mjx-char').remove();
				d3.select('#MJXc-Node-14').selectAll('.mjx-char').remove();
				// Remove 'R' from 'HR'
				d3.select('#MJXc-Node-59').selectAll('.mjx-char').remove();
				d3.select('#MJXc-Node-107').selectAll('.mjx-char').remove();
			}
			
			d3.select
			
		</script>
		<script>
			
		</script>
		
		<!-- <p>  -->
			<!-- \[ \Huge{ S_{pblack} = \frac{1}{1+e^{ \frac{\color{black} w_{\color{black} 5} }{1+e^{\color{black} T\cdot \color{black} w_{\color{black} 1}+ \color{black} H \color{black} R\cdot \color{black} w_{\color{black} 2}}} +\frac{\color{black} w_{\color{black} 6}}{1+e^{\color{black} T\cdot \color{black} w_{\color{black} 3}+ \color{black} H \color{black} R\cdot \color{black} w_{\color{black} 4}}}  } }  }  \] -->
		<!-- </p> -->
	
	</body>
	
</html>