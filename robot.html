<!doctype html>
<html lang="en">
	<head>
		<link rel="stylesheet" href="./bootstrap.min.css"/>
		 <script type="text/javascript"
		   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML">
		</script>
		
	</head>
	
	<body>	
		<script src="./jquery-3.2.1.min.js"> </script>
		<script src="./bootstrap.min.js"> </script>
		<script src="./d3.min.js"> </script>
		<script src="./d3.slider.js"></script>
		<script src="./d3.rebind.js"></script>
		<!-- <script src="./d3-tip.js"> </script> -->
		
		
		
		<div class="container"> 
		<div class = "row"> <div class="col-md-6 col-md-offset-3">
			<h2>Hello!</h2>

			<p>This code shows how we collect our training data set.</p>
			<p>TO DO: Add mathjax to SVG.</p>
			<p>Move input scan to MathJax.</p>
			<p>Replace mathjax with numbers after move</p>
			<p></p>
		</div></div>
		<div id="NetworkGraph"></div>
		<div id="TableOut"></div>
				
		</div>
		<script>
			//Inputs and configuration
			
			//Data for Neural network
			var myData = [
			{"id": 0, "T": 2.781083600, "HR":  2.550537003, "S_true":  0, "y_pred":  0},
			{"id": 1, "T": 1.465489372, "HR":  2.362125076, "S_true":  0, "y_pred":  0},
			{"id": 2, "T": 3.396561688, "HR":  4.400293529, "S_true":  0, "y_pred":  0},
			{"id": 3, "T": 1.388070190, "HR":  1.850220317, "S_true":  0, "y_pred":  0},
			{"id": 4, "T": 3.064072320, "HR":  3.005305973, "S_true":  0, "y_pred":  0},
			{"id": 5, "T": 7.627531214, "HR":  2.759262235, "S_true":  1, "y_pred":  0},
			{"id": 6, "T": 5.332441248, "HR":  2.088626775, "S_true":  1, "y_pred":  0},
			{"id": 7, "T": 6.922596716, "HR":  1.771063670, "S_true":  1, "y_pred":  0},
			{"id": 8, "T": 8.675418651, "HR": -0.242068655, "S_true":  1, "y_pred":  0},
			{"id": 9, "T": 7.673756466, "HR":  3.508563011, "S_true":  1, "y_pred":  0},			
			];
			
			
			//SVG drawing size
			var wd = 500;
			var ht = 400;
			
			//Size of black box
			var rWidth = 4;
			var rHeight = 4;

			//Position of gears within box & Gear size
			var myGears = [
			{"x": -rWidth/4,  "y":  +rHeight/3,  "r":  +1.0},
			{"x": -rWidth/4,  "y":   0,  	     "r":  +0.2},
			{"x": -rWidth/4,  "y":  -rHeight/3,  "r":  +0.7},
			{"x": +rWidth/4,  "y":  +rHeight/3,  "r":  +0.4},
			{"x": +rWidth/4,  "y":   0,  	     "r":  +1.0},
			{"x": +rWidth/4,  "y":  -rHeight/3,  "r":  +0.6},
			];
			
			//Size of inputs blocks
			var blockSize = 1;
		</script>
		<script src="./setupAxes.js"></script>
		<script src='./setupTable_Doctor.js'></script>
		<!-- <script src="./setupGears.js"></script> -->
		<script> 
			
			var columns = ["T", "HR", "S_true"];
			
			var table = d3.select('svg').append("foreignObject")
			  .attr("width", 480)
			  .attr("height", 500)
			  .append("xhtml:body");
			//append body to foreign object(this is missing in your code) 
			//Then you can simply append elements as you used to do in d3 like below.
			
			table.append("table")
					.attr("style", "margin-left: 250px"),
				thead = table.append("thead"),
				tbody = table.append("tbody");

			// append the header row
			thead.append("tr")
				.selectAll("th")
				.data(columns)
				.enter()
				.append("th")
					.text(function(column) { return column; });

			// create a row for each object in the data
			var rows = tbody.selectAll("tr")
				.data(myData)
				.enter()
				.append("tr")
				.attr('id',function (d,i) {return 'data' + i;});

			// create a cell in each row for each column
			var cells = rows.selectAll("td")
				.data(function(row) {
					return columns.map(function(column) {
						return {column: column, value: row[column]};
					});
				})
				.enter()
				.append("td")
				.attr("style", "font-family: Courier;width:50px;");
			
			
			for (i=0;i<=9;i++){
				d3.select("#data"+i%10).selectAll("td")
					.data([myData[i%10].T,
				    myData[i%10].HR,
				    myData[i%10].S_true])
				.html(function(d) { return d.toFixed(2); });
			}
			
			
			
			var doctor = d3.select('svg').selectAll('#doctor').data([0])
				.enter()
				.append('svg:image')
				.attr('id', 'doctor')
				.attr('href','./Robot_Doctor.svg')
				.attr('x', x(3))
				.attr('y', y(1))
				.attr('height',Math.abs(y(5)-y(0)));
			
			var eyeL = d3.select('svg').selectAll('#eyeL').data([0])
							.enter()
							.append('circle')
							.attr('id','eyeL')
							.attr('cx',x(5.1))
							.attr('cy',y(-0.2))
							.attr('r',x(0.1)-x(0))
							.attr("fill", "black");	
							
			var eyeR = d3.select('svg').selectAll('#eyeR').data([0])
							.enter()
							.append('circle')
							.attr('id','eyeR')
							.attr('cx',x(6))
							.attr('cy',y(-0.2))
							.attr('r',x(0.1)-x(0))
							.attr("fill", "black");	
				
			
			var scanDuration = 1200;
			var resetDuration = 500;	
			var advanceTime = 500;
			var trainNumber = 0;
			function scanPatient () {
				d3.selectAll('#scanL').remove();
				d3.selectAll('#scanR').remove();
				d3.selectAll('#eyeL').transition().duration(0)
						.attr('cx',x(5.1))
						.attr('cy',y(-0.2-0.02*(trainNumber%10)));
				d3.selectAll('#eyeR').transition().duration(0)
						.attr('cx',x(6))
						.attr('cy',y(-0.2-0.02*(trainNumber%10)));
				var scanL = d3.select('svg').selectAll('#scanL').data([0])
							.enter()
							.append('line')
							.attr('id','scanL')
							.attr('x1',x(5.1))
							.attr('y1',y(-0.2-0.02*(trainNumber%10)))
							.attr('x2',x(-2))
							.attr('y2',function (d,i){return y(4.3-0.51*(trainNumber%10));})
							.attr("stroke-width", 2)
							.attr("stroke", "black");
							
				var scanR = d3.select('svg').selectAll('#scanR').data([0])
							.enter()
							.append('line')
							.attr('id','scanR')
							.attr('x1',x(6))
							.attr('y1',y(-0.2-0.02*(trainNumber%10)))
							.attr('x2',x(-2))
							.attr('y2',function (d,i){return y(4.3-0.51*(trainNumber%10));})
							.attr("stroke-width", 2)
							.attr("stroke", "black");
			
			
				eyeL.transition().duration(scanDuration)
					<!-- .attr('cy',y(-0.4)) -->
					.attr('cx',x(5.15))
					.on('end', function(){
					  return eyeL.transition().duration(resetDuration)
								.attr('cx',x(5.1))
								.attr('cy',y(-0.2-0.02*((trainNumber+1)%10)));} 
					);
				eyeR.transition().duration(scanDuration)
					<!-- .attr('cy',y(-0.4)) -->
					.attr('cx',x(6.05))
					.on('end', function(){
					  return eyeR.transition().duration(resetDuration)
								.attr('cx',x(6))
								.attr('cy',y(-0.2-0.02*((trainNumber+1)%10)));} 
					);
				
				scanL.transition().duration(scanDuration)
					.attr('x1',x(5.1))
					.attr('x2',x(0))
					.on('end', function(){
					  return scanL.remove();} 
					);
				scanR.transition().duration(scanDuration)
					.attr('x1',x(6))
					.attr('x2',x(0))
					.on('end', function(){
						console.log(trainNumber);
						updateTable(trainNumber);
						trainNumber++;												
					  return scanR.remove();} 
					);
						

					<!-- d3.select('#MJXc-Node-8').selectAll('.mjx-char').html('S')	 -->
				
			}
			
			<!-- var theEqn = d3.select('svg').append("foreignObject") -->
			  <!-- .attr("width", 480) -->
			  <!-- .attr("height", 500) -->
			  <!-- .append("xhtml:body"); -->
			
			<!-- var testing = theEqn.append("p") -->
				<!-- .attr("style", "margin-left: 250px") -->
				<!-- .attr('id','MathExample') -->
				<!-- .text(' \[ \Huge{ S_{pred} = \frac{1}{1+e^{ \frac{\color{red} w_{\color{red} 5} }{1+e^{\color{blue} T\cdot \color{red} w_{\color{red} 1}+ \color{green} H \color{green} R\cdot \color{red} w_{\color{red} 2}}} +\frac{\color{red} w_{\color{red} 6}}{1+e^{\color{blue} T\cdot \color{red} w_{\color{red} 3}+ \color{green} H \color{green} R\cdot \color{red} w_{\color{red} 4}}}  } }  }  \] '); -->
			
			<!-- MathJax.Hub.Queue(["Typeset",MathJax.Hub,"MathExample"]); -->
			
			scanPatient();
			
			
		</script>
		<p> 
			\[ \Huge{ S_{pred} = \frac{1}{1+e^{ \frac{\color{red} w_{\color{red} 5} }{1+e^{\color{blue} T\cdot \color{red} w_{\color{red} 1}+ \color{green} H \color{green} R\cdot \color{red} w_{\color{red} 2}}} +\frac{\color{red} w_{\color{red} 6}}{1+e^{\color{blue} T\cdot \color{red} w_{\color{red} 3}+ \color{green} H \color{green} R\cdot \color{red} w_{\color{red} 4}}}  } }  }  \]
		</p>
	
	</body>
	
</html>